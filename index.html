<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JUMANJI â€” Web Hunt</title>
<!-- QR Scanner CDN -->
<script src="https://cdn.jsdelivr.net/npm/html5-qrcode@2.3.8/minified/html5-qrcode.min.js"></script>
<style>
  /* Basic Reset */
  * { box-sizing: border-box; margin: 0; padding: 0; }
  html, body { height: 100%; font-family: Arial, sans-serif; background: linear-gradient(#14321a,#2b6b33); color: #fff; }
  body { display: flex; justify-content: center; align-items: center; padding: 16px; }

  /* Card container */
  .card { width: 100%; max-width: 420px; background: rgba(0,0,0,0.3); border-radius: 16px; padding: 20px; text-align: center; box-shadow: 0 6px 20px rgba(0,0,0,0.5); }

  h1 { font-size: 28px; margin-bottom: 12px; color: #fff8d6; text-shadow: 0 2px 4px rgba(0,0,0,0.5); }
  .hint { background: #f9f4e6; color: #2e2a18; border-radius: 10px; padding: 12px; margin: 12px 0; font-weight: 600; }

  .btn { background: linear-gradient(#2b8a3a, #1f6d2a); border: none; padding: 12px 18px; border-radius: 10px; color: #fff; font-weight: 700; font-size: 16px; cursor: pointer; margin-top: 8px; width: 100%; }
  .btn:active { transform: translateY(2px); }

  #scannerWrap { display: none; margin-top: 12px; }
  .toast { margin-top:12px; padding:10px; border-radius:8px; font-weight:700; display:none; }
  .toast.success { background: #b9f0c2; color:#0a3816; }
  .toast.error { background: #ffd2d2; color:#4a0a0a; }

  @media (max-width:420px){ h1{font-size:24px;} .hint{font-size:14px;} }
</style>
</head>
<body>
  <div class="card">
    <h1>ðŸŒ¿ JUMANJI</h1>
    <div id="hintBox" class="hint">Find the hidden code near the old tree!</div>
    <button id="scanBtn" class="btn">Scan QR</button>

    <div id="scannerWrap">
      <div id="reader" style="width:100%;"></div>
      <button id="stopBtn" class="btn" style="background:#7a2b2b;">Stop Scanner</button>
    </div>

    <div id="toast" class="toast"></div>
  </div>

<script>
const SECRET_CODE = "x02hy583";
const scanBtn = document.getElementById("scanBtn");
const stopBtn = document.getElementById("stopBtn");
const scannerWrap = document.getElementById("scannerWrap");
const toast = document.getElementById("toast");
let scannerRunning = false;
let html5QrScanner = null;

function showToast(message,type="success",duration=1800){
  toast.textContent = message;
  toast.className = "toast "+(type==="success"?"success":"error");
  toast.style.display="block";
  setTimeout(()=>{ toast.style.display="none"; }, duration);
}

function startScanner(){
  if(scannerRunning) return;
  scannerWrap.style.display="block";
  try{
    html5QrScanner = new Html5Qrcode("reader",{verbose:false});
    Html5Qrcode.getCameras().then(cameras=>{
      if(cameras && cameras.length){
        const cameraId = cameras.find(c=>/back|rear|environment/i.test(c.label))?.id || cameras[0].id;
        html5QrScanner.start({deviceId:{exact:cameraId}}, {fps:10, qrbox:250},
          decodedText=>{
            if(decodedText === SECRET_CODE){
              showToast("Code accepted! Redirecting...", "success", 2000);
              html5QrScanner.stop().then(()=>{ html5QrScanner.clear(); scannerRunning=false; setTimeout(()=>{ window.location.href="loading.html"; },900); });
            } else{
              showToast("Invalid QR Code! Try again.", "error",1400);
            }
          },
          ()=>{}
        ).then(()=>{scannerRunning=true;});
      } else{ showToast("No cameras found", "error",2000);}
    }).catch(e=>showToast("Camera access denied", "error",2500));
  }catch(e){ showToast("Scanner not available", "error",2500);}
}

function stopScanner(){
  if(html5QrScanner){
    html5QrScanner.stop().then(()=>{ html5QrScanner.clear(); scannerRunning=false; scannerWrap.style.display="none"; });
  } else { scannerWrap.style.display="none"; scannerRunning=false; }
}

scanBtn.addEventListener("click", ()=>{ startScanner(); });
stopBtn.addEventListener("click", ()=>{ stopScanner(); });
</script>
</body>
</html>
